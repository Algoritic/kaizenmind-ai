from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
from typing import Dict

from static_analysis import run_static_pentest

app = FastAPI()

class StaticPentestRequest(BaseModel):
    lang: str
    cwd: str

@app.post("/static_pentest")
async def static_pentest(request: StaticPentestRequest):
    try:
        results = run_static_pentest(request.lang, Path(request.cwd))
        return results
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))
