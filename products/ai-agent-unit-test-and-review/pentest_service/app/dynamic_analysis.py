
import httpx
from typing import Dict, List

SECOPS_MCP_URL = "http://secops-mcp:8000/run_tool"

def run_dynamic_pentest(tool: str, args: List[str]) -> Dict:
    try:
        with httpx.Client() as client:
            response = client.post(SECOPS_MCP_URL, json={"tool": tool, "args": args}, timeout=300)
            response.raise_for_status()
            return response.json()
    except httpx.HTTPStatusError as e:
        return {"error": f"HTTP error occurred: {e.response.status_code} - {e.response.text}"}
    except httpx.RequestError as e:
        return {"error": f"An error occurred while requesting {e.request.url!r}: {e}"}
